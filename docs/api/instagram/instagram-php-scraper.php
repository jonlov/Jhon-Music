<?php /*! * instagram-php-scraper http: * Scrapes an instagram user's photos with PHP * Developed by Jonathan Lovera * MIT license */ // Defining the basic cURL function $user = "jhonvzla_"; function curl($url) { $ch = curl_init(); // Initialising cURL curl_setopt($ch, CURLOPT_URL, $url); // Setting cURL's URL option with the $url variable passed into the function curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE); $data = curl_exec($ch); curl_close($ch); return $data; } $scraped_website = curl("https://www.instagram.com/$user/"); $document = new DOMDocument(); $document->loadHTML($scraped_website); $selector = new DOMXPath($document); $anchors = $selector->query('/html/body//script'); header('Content-type: application/json; charset=utf-8'); foreach($anchors as $a) { $text = $a->nodeValue; $text = str_replace("window._sharedData = ","",$text); $text = str_replace("\n","",$text); $text = str_replace("(window,document,'script','//connect.facebook.net/en_US/fbevents.js');","",$text); $text = str_replace("!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}","",$text); $text = str_replace("fbq('init', '1425767024389221');","",$text); $text = str_replace("fbq('track', 'PageView');","",$text); $text = str_replace("window._timings.domInteractive = Date.now()","",$text); $text = str_replace(";","",$text); $text = str_replace('&quot;', '"', $text); $text = utf8_encode($text); $text = json_decode($text); if(json_encode($text) != 'null') echo json_encode($text->entry_data->ProfilePage[0]->user->media->nodes); } ?>